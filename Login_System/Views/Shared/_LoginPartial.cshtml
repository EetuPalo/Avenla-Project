@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.Localization
@using System.Globalization;
@using Microsoft.AspNetCore.Builder;
@using Microsoft.Extensions.Options;
@inject SignInManager<AppUser> SignInManager
@inject UserManager<AppUser> UserManager

@inject IOptions<RequestLocalizationOptions> LocOps

@{
    var requestCulture = Context.Features.Get<IRequestCultureFeature>();
    var cultureItems = LocOps.Value.SupportedUICultures
        .Select(c => new SelectListItem { Value = c.Name, Text = c.DisplayName })
        .ToList();
}
<script type="text/javascript" src="~/lib/bootstrap-select-1.13.14/dist/js/bootstrap-select.js" runat="server"></script>

<ul class="navbar-nav">

    @if (SignInManager.IsSignedIn(User))
    {
        <li class="dropdown show">
            <a class="btn dropdown-toggle text-dark" href="#" role="button" id="nameDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                @Resources.Resources.User_Hello @TempData.Peek("UserFullNames")!
            </a>
            <div class="dropdown-menu" aria-labelledby="nameDropdown">
                <a class="dropdown-item" asp-area="" asp-controller="Dashboard" asp-action="Index">@Resources.Resources.Dashboard</a>
                <a class="dropdown-item" asp-area="" asp-controller="AppUsers" asp-action="Details" asp-route-id="@ViewBag.UserID" asp-route-source="shortcut">@Resources.Resources.Layout_Profile</a>
                <a class="dropdown-item" asp-area="" asp-controller="UserSkills" asp-action="SkillList" asp-route-id="@ViewBag.UserID" asp-route-name="latest">@Resources.Resources.Layout_Skills</a>
                <a class="dropdown-item" asp-area="" asp-controller="UserCertificates" asp-action="Index" asp-route-id="@ViewBag.UserID" asp-route-source="shortcut">@Resources.Resources.Layout_Certificates</a>
                <a class="dropdown-item" href="@Url.Action("Logout", "Account")">@Resources.Resources.Layout_Logout</a>
            </div>
        </li>

        <li class="align-middle dropdown show">
            <div class="align-middle">
                <form id="selectLanguage" asp-controller="Home"
                      asp-action="SetLanguage" asp-route-returnUrl="@Context.Request.Path"
                      method="post" class="form-horizontal" role="form">

                    <select title="Language" id="pickLang" class="selectpicker form-control form-control-sm align-middle" name="culture"
                            onchange="this.form.submit();"
                            asp-for="@requestCulture.RequestCulture.UICulture.Name">

                        <option data-content='<img src="../img/fin-flag.png" width="21" height="16" style="margin: 3px;" class="d-inline-block align-top" alt="">Finnish' value="fi-FI">FI</option>
                        <option data-content='<img src="../img/us-flag.png" width="21" height="16" style="margin: 3px;" class="d-inline-block align-top" alt="">English' value="en-EN">EN</option>

                    </select>
                </form>
            </div>
        </li>
    }
    else
    {
        <li class="nav-item">
            <a class="nav-link text-dark" href="@Url.Action("Login", "Account")">@Resources.Resources.Layout_Login</a>
        </li>
        <li class="nav-item">
            <!--<a class="nav-link text-dark" href="@Url.Action("Register", "Account")">Register</a>-->
        </li>
        <li>
            <div>
                <form id="selectLanguage" asp-controller="Home"
                      asp-action="SetLanguage" asp-route-returnUrl="@Context.Request.Path"
                      method="post" class="form-horizontal" role="form">
                    <select class="form-control form-control-sm" name="culture"
                            onchange="this.form.submit();"
                            asp-for="@requestCulture.RequestCulture.UICulture.Name">
                        <option hidden></option>
                        <option value="fi-FI">FI</option>
                        <option value="en-GB">EN</option>
                    </select>
                </form>
            </div>
        </li>
    }
</ul>
<script>
    $('.selectpicker').selectpicker();
    $('.selectpicker').selectpicker('val', 'value');

    //$('#pickLang').on('changed.bs.select', function (e, clickedIndex, isSelected, previousValue) {
       
    //});
    //$('.selectpicker').on('changed.bs.select', function (e, clickedIndex, newValue, oldValue) {
    //    var selected = $(e.currentTarget).val();
    //});

</script>




